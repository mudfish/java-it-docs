(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{325:function(s,a,t){s.exports=t.p+"assets/img/2022-09-08-15-25-10.a27e3dfe.png"},326:function(s,a,t){s.exports=t.p+"assets/img/2022-09-13-20-42-47.bbdff446.png"},327:function(s,a,t){s.exports=t.p+"assets/img/2022-09-13-20-46-34.66c88bce.png"},328:function(s,a){s.exports="data:image/png;base64,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"},329:function(s,a,t){s.exports=t.p+"assets/img/2022-09-13-21-07-51.b45a2b11.png"},364:function(s,a,t){"use strict";t.r(a);var e=t(6),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"基础"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础"}},[s._v("#")]),s._v(" 基础")]),s._v(" "),a("h3",{attrs:{id:"关于kubectl、kubelet和kubeadm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于kubectl、kubelet和kubeadm"}},[s._v("#")]),s._v(" 关于kubectl、Kubelet和Kubeadm")]),s._v(" "),a("p",[s._v("kubectl：是Kubernetes 的命令行工具，人们通常通过它与Kubernetes 进行交互。"),a("br"),s._v("\nKubelet：是kubernetes 工作节点上的一个代理组件，运行在每个节点上。\nKubeadm：是一个提供了 kubeadm init 和 kubeadm join 的工具， 作为创建Kubernetes 集群的“快捷途径” 的最佳实践（用于创建集群）")]),s._v(" "),a("h3",{attrs:{id:"namespace命名空间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#namespace命名空间"}},[s._v("#")]),s._v(" namespace命名空间")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("kubectl get namespace\nkubectl create namespace "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"pod、service、deployment关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod、service、deployment关系"}},[s._v("#")]),s._v(" pod、service、deployment关系？")]),s._v(" "),a("ul",[a("li",[s._v("pod：k8s集群调度得最小单元，1个pod可包含多个容器，类比豌豆荚。")]),s._v(" "),a("li",[s._v("service：访问pod的入口，通过pod标签与pod进行关联\n"),a("ul",[a("li",[s._v("ClusterIP 默认")]),s._v(" "),a("li",[s._v("NodePort: 每个node上分配一个端口作为外部访问入口")])])])]),s._v(" "),a("h3",{attrs:{id:"有状态服务和无状态服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#有状态服务和无状态服务"}},[s._v("#")]),s._v(" 有状态服务和无状态服务？")]),s._v(" "),a("ol",[a("li",[s._v("有状态的应用副本名是有规则的，且重启后副本名称不会变，例如部署个mysql，两个副本：mysql-1､mysql-2,重启后依旧是mysql-1/2;而无状态的副本重启会名称会变；")]),s._v(" "),a("li",[s._v("可以为有状态的副本创建headless服务，这时候mysql-1解析到的是POD的IP；如果用服务名访问，则会依次解析到不同的PODIP（就是第一次解析到mysql-1,第二次解析到mysql-2)；")]),s._v(" "),a("li",[s._v("使用pvc时，无状态的只有一个副本能挂上pv，有状态的每一个副本都会挂到一个pv，且重启后会确保挂到重启前的pv上。")])]),s._v(" "),a("h2",{attrs:{id:"节点架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#节点架构"}},[s._v("#")]),s._v(" 节点架构")]),s._v(" "),a("p",[a("img",{attrs:{src:t(325),alt:""}})]),s._v(" "),a("ul",[a("li",[s._v("Api Server：所有服务访问的唯一入口")]),s._v(" "),a("li",[s._v("Controller Manager：维护副本数量")]),s._v(" "),a("li",[s._v("Scheduler：负责工作负载利用率，并将Pod分配给新节点。")]),s._v(" "),a("li",[s._v("ETCD：键值对数据库，负责存储k8s集群所有重要信息")]),s._v(" "),a("li",[s._v("Kubelet：直接和容器引擎交互实现容器的生命周期管理")]),s._v(" "),a("li",[s._v("kube proxy：负责写入规则至iptables、ipvs实现服务映射访问")]),s._v(" "),a("li",[s._v("CoreDNS：可以为集群中的SVC创建一个域名IP的对应关系解析")]),s._v(" "),a("li",[s._v("Dashboard：给K8s集群提供一个B/S结构访问体系")]),s._v(" "),a("li",[s._v("Ingress Controller：官方只能实现四层代理，Ingress可以实现七层代理")]),s._v(" "),a("li",[s._v("Federation：提供一个可以跨集群中心多K8s统一管理功能")]),s._v(" "),a("li",[s._v("ELK：提供k8s集群日志统一分析接入平台")]),s._v(" "),a("li",[s._v("Prometheus：提供k8s集群的监控能力")])]),s._v(" "),a("h1",{attrs:{id:"集群搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集群搭建"}},[s._v("#")]),s._v(" 集群搭建")]),s._v(" "),a("p",[s._v("参考：https://www.modb.pro/db/332165")]),s._v(" "),a("blockquote",[a("p",[s._v("如果没有特别说明，以下操作在3个节点都要执行！")])]),s._v(" "),a("h2",{attrs:{id:"节点规划"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#节点规划"}},[s._v("#")]),s._v(" 节点规划")]),s._v(" "),a("ul",[a("li",[s._v("操作系统：centos7.9")])]),s._v(" "),a("p",[s._v("主节点：192.168.182.101 2c2g 20g存储 "),a("br"),s._v("\n工作节点：192.168.182.102 2c2g 20g存储 "),a("br"),s._v("\n工作节点：192.168.182.103 2c2g 20g存储")]),s._v(" "),a("h2",{attrs:{id:"安装虚拟机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装虚拟机"}},[s._v("#")]),s._v(" 安装虚拟机")]),s._v(" "),a("ul",[a("li",[s._v("配置主机名")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 根据规划设置主机名【k8smaster1 节点上操作】")]),s._v("\nhostnamectl set-hostname ks8master1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 根据规划设置主机名【k8snode1 节点上操作】")]),s._v("\nhostnamectl set-hostname k8snode1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 根据规划设置主机名【k8snode2 节点操作】")]),s._v("\nhostnamectl set-hostname k8snode2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ul",[a("li",[s._v("配置hosts")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/hosts "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n192.168.182.101 k8smaster1\n192.168.182.102 k8snode1\n192.168.182.103 k8snode2\nEOF")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[s._v("配置网络\n将原有dhcp模式改为指定静态IP")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/sysconfig/network-scripts/ifcfg-ens33\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TYPE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ethernet"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PROXY_METHOD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"none"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BROWSER_ONLY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"no"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BOOTPROTO")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"static"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DEFROUTE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("IPV4_FAILURE_FATAL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"no"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("IPV6INIT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("IPV6_AUTOCONF")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("IPV6_DEFROUTE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("IPV6_FAILURE_FATAL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"no"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("IPV6_ADDR_GEN_MODE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stable-privacy"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ens33"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9541c16d-03e2-4601-b378-d118d9feeb8c"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DEVICE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ens33"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ONBOOT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("IPADDR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.182.101"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PREFIX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"24"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GATEWAY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.182.2"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DNS1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"119.29.29.29"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("ul",[a("li",[s._v("更改yum源")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/yum.repos.d/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 清空本地缓存")]),s._v("\nyum clean all\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新生成缓存")]),s._v("\nyum makecache\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ul",[a("li",[s._v("关闭selinux")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭 selinux")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 临时关闭【立即生效】告警，不启用，Permissive，查看使用 getenforce 命令")]),s._v("\nsetenforce "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 永久关闭【重启生效】")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/SELINUX=enforcing/\\SELINUX=disabled/'")]),s._v(" /etc/selinux/config  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[s._v("关闭swap")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭 swap")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 临时关闭【立即生效】查看使用 free 命令")]),s._v("\nswapoff -a \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 永久关闭【重启生效】")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -ri "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/.*swap.*/#&/'")]),s._v(" /etc/fstab\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[s._v("主机时间同步")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装依赖包")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ntpdate\nntpdate ntp1.aliyun.com\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置定时任务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" -e\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" */1 * * * ntpdate ntp1.aliyun.com\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ul",[a("li",[s._v("设置防火墙为 Iptables 并设置空规则")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl stop firewalld "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl disable firewalld\n\nyum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" iptables-services "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl start iptables "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v("  iptables "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" iptables -F "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" iptables save\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[s._v("配置网桥和地址转发")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/sysctl.d/k8s.conf\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  /etc/sysctl.d/k8s.conf  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF \nnet.bridge.bridge-nf-call-iptables=1\nnet.bridge.bridge-nf-call-ip6tables=1\nnet.ipv4.ip_forward=1\nnet.ipv4.tcp_tw_recycle=0\nvm.swappiness=0  #  禁止使用swap  空间，只有当系统  OOM  时才允许使用它\nvm.overcommit_memory=1  #  不检查物理内存是否够用\nvm.panic_on_oom=0  #  开启  OOM\nfs.inotify.max_user_instances=8192 fs.inotify.max_user_watches=1048576 \nfs.file-max=52706963 \nfs.nr_open=52706963 \nnet.ipv6.conf.all.disable_ipv6=1 \nnet.netfilter.nf_conntrack_max=2310720\nEOF")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 加载网桥过滤模块")]),s._v("\nmodprobe br_netfilter\nmodprobe ip_conntrack\nlsmod "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" conntrack\n\nsysctl -p /etc/sysctl.d/k8s.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("ul",[a("li",[s._v("关闭多余服务")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl stop postfix "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl disable postfix\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("开启ipvs")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装ipset及ipvsadm")]),s._v("\nyum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ipset ipvsadm\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("在所有节点执行脚本：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/sysconfig/modules/ipvs.modules "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\nmodprobe -- ip_vs                                                                       \nmodprobe -- ip_vs_rr\nmodprobe -- ip_vs_wrr\nmodprobe -- ip_vs_sh\nmodprobe -- nf_conntrack_ipv4\nEOF")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("755")]),s._v(" /etc/sysconfig/modules/ipvs.modules "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" /etc/sysconfig/modules/ipvs.modules "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("lsmod "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -e ip_vs -e nf_conntrack_ipv4\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("ul",[a("li",[s._v("升级系统内核")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v("  -Uvh  http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  安装完成后检查  /boot/grub2/grub.cfg  中对应内核  menuentry  中是否包含  initrd16  配置，如果没有，再安装一次！")]),s._v("\nyum  --enablerepo"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("elrepo-kernel  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("  -y  kernel-lt "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置开机从新内核启动")]),s._v("\ngrub2-set-default  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'CentOS  Linux  (4.4.189-1.el7.elrepo.x86_64)  7  (Core)'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -r\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5.4.212-1.el7.elrepo.x86_64")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装docker"}},[s._v("#")]),s._v(" 安装docker")]),s._v(" "),a("ul",[a("li",[s._v("获取yum源")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置 docker 的 yum 源【阿里云】")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/etc/yum.repos.d/docker.repo"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[docker-ce-edge]\nname=Docker CE Edge - \\"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$basearch")]),s._v("\nbaseurl=https://mirrors.aliyun.com/docker-ce/linux/centos/7/\\"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$basearch")]),s._v("/edge\nenabled=1\ngpgcheck=1\ngpgkey=https://mirrors.aliyun.com/docker-ce/linux/centos/gpg\nEOF")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("yum list docker-ce.x86_64 --showduplicates "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" -r\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum 方式安装 docker")]),s._v("\nyum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --setopt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("obsoletes"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" docker-ce-18.06.3.ce-3.e17\n\nyum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 docker 版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" --version\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置 docker 的镜像源【阿里云】")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /etc/docker\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('EOF\n{\n  "registry-mirrors": ["https://b9pmyelo.mirror.aliyuncs.com"]\n}\nEOF')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行 docker 自启")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 docker")]),s._v("\nsystemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 docker 状态")]),s._v("\nsystemctl status "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"安装-kubeadm-kubelet-和-kubectl"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-kubeadm-kubelet-和-kubectl"}},[s._v("#")]),s._v(" 安装 kubeadm，kubelet 和 kubectl")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置 k8s 的 yum 源【阿里云】")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/yum.repos.d/kubernetes.repo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF\n[kubernetes]\nname=Kubernetes\nbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64\nenabled=1\ngpgcheck=0\nrepo_gpgcheck=0\ngpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg\nEOF")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 kubelet、kubeadm、kubectl，同时指定版本 1.18.0")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y kubelet-1.18.0 kubeadm-1.18.0 kubectl-1.18.0\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置开机自启")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" kubelet\nsystemctl start kubelet\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"初始化集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化集群"}},[s._v("#")]),s._v(" 初始化集群")]),s._v(" "),a("p",[a("code",[s._v("master节点操作")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("kubeadm init --apiserver-advertise-address"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".182.101 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n --image-repository registry.aliyuncs.com/google_containers "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n --kubernetes-version v1.18.0 --service-cidr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.96")]),s._v(".0.0/12 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n --pod-network-cidr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.244")]),s._v(".0.0/16\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# apiserver地址为master节点地址")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 记住命令")]),s._v("\nkubeadm "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".182.101:6443 --token 9zjkpp.iz8162zncbzwl7y3 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --discovery-token-ca-cert-hash sha256:57a41aea4ea0220fc5ea92e22115259903c4dc0dde89eb66834666ff48e8cf7a\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[a("img",{attrs:{src:t(326),alt:""}})]),s._v(" "),a("ul",[a("li",[a("code",[s._v("master节点操作")])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -i /etc/kubernetes/admin.conf "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" -u"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" -g"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"cni网络插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cni网络插件"}},[s._v("#")]),s._v(" CNI网络插件")]),s._v(" "),a("p",[a("code",[s._v("master节点操作")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:t(327),alt:""}})]),s._v(" "),a("h3",{attrs:{id:"将节点node1和node2加入集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将节点node1和node2加入集群"}},[s._v("#")]),s._v(" 将节点node1和node2加入集群")]),s._v(" "),a("p",[s._v("执行上面的kubeadm join...命令")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看节点状态")]),s._v("\nkubectl get "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:t(328),alt:""}})]),s._v(" "),a("h2",{attrs:{id:"测试集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试集群"}},[s._v("#")]),s._v(" 测试集群")]),s._v(" "),a("p",[a("code",[s._v("master节点操作")])]),s._v(" "),a("ul",[a("li",[s._v("在Kubernetes集群中创建一个pod，验证是否正常运行")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载nginx 会联网 pull nginx image")]),s._v("\nkubectl create deployment nginx --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看状态")]),s._v("\nkubectl get pod\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暴露端口")]),s._v("\nkubectl expose deployment nginx --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NodePort\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看一下对外的端口")]),s._v("\nkubectl get pod,svc\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看集群状态")]),s._v("\nkubectl get cs\nkubectl cluster-info\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[a("img",{attrs:{src:t(329),alt:""}})]),s._v(" "),a("h2",{attrs:{id:"异常处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#异常处理"}},[s._v("#")]),s._v(" 异常处理")]),s._v(" "),a("h3",{attrs:{id:"error-missing-or-incomplete-configuration-info"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#error-missing-or-incomplete-configuration-info"}},[s._v("#")]),s._v(" error: Missing or incomplete configuration info")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/profile\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增一行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("KUBERNETES_MASTER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1:8080"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存退出")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 刷新环境变量")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h1",{attrs:{id:"kubectl常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubectl常用命令"}},[s._v("#")]),s._v(" kubectl常用命令")]),s._v(" "),a("h3",{attrs:{id:"pod操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod操作"}},[s._v("#")]),s._v(" pod操作")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("kubectl get pod\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看指定命名空间下pod")]),s._v("\nkubectl get pod -n kube-system\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看pod状态")]),s._v("\nkubectl describe pod\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看一下对外的端口")]),s._v("\nkubectl get pod,svc\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除pod")]),s._v("\nkubectl delete pods podname -n default\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h3",{attrs:{id:"service操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service操作"}},[s._v("#")]),s._v(" service操作")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("kubectl expose deployment.apps nginx-app --type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ClusterIP --target-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" --port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h1",{attrs:{id:"资源清单文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#资源清单文件"}},[s._v("#")]),s._v(" 资源清单文件")]),s._v(" "),a("ul",[a("li",[s._v("创建service")])]),s._v(" "),a("p",[a("code",[s._v("create-deployment-service-clusterip.yaml")])]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apps/v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deployment\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("app2\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("replicas")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchLabels")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginxapp2\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("imagePullPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" IfNotPresent\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apps/v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("app2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("svc\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ClusterIP\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("kubectl apply -f create-deployment-service-clusterip.yaml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);